(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90053,       2087]
NotebookOptionsPosition[     88026,       2047]
NotebookOutlinePosition[     88482,       2064]
CellTagsIndexPosition[     88439,       2061]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8516094983531446`*^9, 3.851609613779417*^9}, {
   3.8516096486754904`*^9, 3.8516098737248335`*^9}, {3.8516099062116203`*^9, 
   3.8516099385367966`*^9}, 3.851610111905197*^9, {3.851659110257635*^9, 
   3.8516591238756337`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"92928561-9f78-4bfc-8796-b3d12eac8b59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Stencils", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Sp", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "4"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "5"}], "/", "6"}], ",", " ", 
        RowBox[{"3", "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", " ", 
        RowBox[{"1", "/", "12"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sm", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "12"}], ",", " ", 
        RowBox[{"1", "/", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}], ",", " ", 
        RowBox[{"5", "/", "6"}], ",", " ", 
        RowBox[{"1", "/", "4"}], ",", " ", "0", ",", " ", "0"}], "}"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sps1", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "16"}], "/", "60"}], ",", 
        RowBox[{
         RowBox[{"-", "45"}], "/", "60"}], ",", 
        RowBox[{"80", "/", "60"}], ",", 
        RowBox[{
         RowBox[{"-", "20"}], "/", "60"}], ",", 
        RowBox[{"1", "/", "60"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sps2", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "75"}], "/", "240"}], ",", 
        RowBox[{
         RowBox[{"-", "128"}], "/", "240"}], ",", 
        RowBox[{"225", "/", "240"}], ",", 
        RowBox[{
         RowBox[{"-", "25"}], "/", "240"}], ",", 
        RowBox[{"3", "/", "240"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sps3", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "192"}], "/", "210"}], ",", 
        RowBox[{
         RowBox[{"+", "35"}], "/", "210"}], ",", "1", ",", 
        RowBox[{
         RowBox[{"-", "63"}], "/", "210"}], ",", 
        RowBox[{"10", "/", "210"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sms1", " ", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "8"}], "/", "30"}], ",", 
        RowBox[{"45", "/", "30"}], ",", 
        RowBox[{
         RowBox[{"-", "120"}], "/", "30"}], ",", 
        RowBox[{"80", "/", "30"}], ",", 
        RowBox[{"3", "/", "30"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sms2", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "15"}], "/", "30"}], ",", 
        RowBox[{"64", "/", "30"}], ",", 
        RowBox[{
         RowBox[{"-", "90"}], "/", "30"}], ",", 
        RowBox[{"35", "/", "30"}], ",", 
        RowBox[{"6", "/", "30"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sms3", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "64"}], "/", "210"}], ",", 
        RowBox[{"175", "/", "210"}], ",", 
        RowBox[{
         RowBox[{"-", "350"}], "/", "210"}], ",", 
        RowBox[{"189", "/", "210"}], ",", 
        RowBox[{"50", "/", "210"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sPs1b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "50"}], "/", "210"}], ",", 
        RowBox[{
         RowBox[{"-", "189"}], "/", "210"}], ",", 
        RowBox[{"350", "/", "210"}], ",", 
        RowBox[{
         RowBox[{"-", "175"}], "/", "210"}], ",", 
        RowBox[{"64", "/", "210"}]}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "2", ",", "2.5"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"sPs2b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "6"}], "/", "30"}], ",", 
        RowBox[{
         RowBox[{"-", "35"}], "/", "30"}], ",", 
        RowBox[{"90", "/", "30"}], ",", 
        RowBox[{
         RowBox[{"-", "64"}], "/", "30"}], ",", 
        RowBox[{"15", "/", "30"}]}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "1.5", ",", "2"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"sPs3b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "3"}], "/", "60"}], ",", 
        RowBox[{
         RowBox[{"-", "80"}], "/", "60"}], ",", 
        RowBox[{"120", "/", "60"}], ",", 
        RowBox[{
         RowBox[{"-", "45"}], "/", "60"}], ",", 
        RowBox[{"8", "/", "60"}]}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0.5", ",", "1", ",", "1.5"}], "*)"}],
    "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"sMs1b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "10"}], "/", "420"}], ",", 
        RowBox[{"63", "/", "420"}], ",", 
        RowBox[{
         RowBox[{"-", "210"}], "/", "420"}], ",", 
        RowBox[{
         RowBox[{"-", "35"}], "/", "420"}], ",", 
        RowBox[{"192", "/", "420"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "2"}], ",", "0", ",", "1"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"sMs2b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "/", "240"}], ",", 
        RowBox[{"25", "/", "240"}], ",", 
        RowBox[{
         RowBox[{"-", "225"}], "/", "240"}], ",", 
        RowBox[{"128", "/", "240"}], ",", 
        RowBox[{"75", "/", "240"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"sMs3b", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "\[CapitalDelta]"}], ")"}], " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "60"}], ",", 
        RowBox[{"20", "/", "60"}], ",", 
        RowBox[{
         RowBox[{"-", "80"}], "/", "60"}], ",", 
        RowBox[{"45", "/", "60"}], ",", 
        RowBox[{"16", "/", "60"}], ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"//", "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
               "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}],
        "//"}], "//"}], "//", "/"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8516094983531446`*^9, 3.851609613779417*^9}, {
   3.8516096486754904`*^9, 3.8516098737248335`*^9}, {3.8516099062116203`*^9, 
   3.8516099385367966`*^9}, 3.851610111905197*^9, {3.851659110257635*^9, 
   3.8516591238756337`*^9}, {3.851868420836193*^9, 
   3.851868562189302*^9}},ExpressionUUID->"4a26795d-819f-4858-9da9-\
b34a67d0100f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Matricies", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Rx", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", "2"}], ")"}]}], ")"}], "*", 
      RowBox[{"(", GridBox[{
         {
          SqrtBox["2"], "0", "0", "0", "0", "0"},
         {"0", "1", "0", "0", "0", 
          RowBox[{"-", "1"}]},
         {"0", "0", "1", "0", "1", "0"},
         {"0", "0", "0", 
          SqrtBox["2"], "0", "0"},
         {"0", "1", "0", "0", "0", "1"},
         {"0", "0", "1", "0", 
          RowBox[{"-", "1"}], "0"}
        }], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bx", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"0", "0", "0", "0", "0", "0"},
        {"0", "0", "0", "0", "0", 
         RowBox[{"-", "1"}]},
        {"0", "0", "0", "0", "1", "0"},
        {"0", "0", "0", "0", "0", "0"},
        {"0", "0", "1", "0", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "0", "0", "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"//", "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
               "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}],
        "//"}], "//"}], "//", "/"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Dispersion", " ", "Relations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wConst", "[", 
     RowBox[{"kx_", ",", "\[CapitalDelta]_"}], "]"}], "=", 
    FractionBox[
     RowBox[{
      RowBox[{"10", " ", "\[ImaginaryI]"}], "+", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", 
         "\[CapitalDelta]"}]]}], "-", 
      RowBox[{"18", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}], "+", 
      RowBox[{"6", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
        "2", " ", "\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}], 
      "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
        "3", " ", "\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}]}], 
     RowBox[{"12", " ", "\[CapitalDelta]"}]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"//", "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
                    "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], 
               "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}], "//"}],
        "//"}], "//"}], "//", "/"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8516094983531446`*^9, 3.851609613779417*^9}, {
   3.8516096486754904`*^9, 3.8516098737248335`*^9}, {3.8516099062116203`*^9, 
   3.8516099385367966`*^9}, 3.851610111905197*^9, {3.8516601174414883`*^9, 
   3.8516601782179527`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"b10cf8ca-9da7-47d9-b3d5-a7ad51bad5a9"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"10", " ", "\[ImaginaryI]"}], "+", 
   RowBox[{"3", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "kx", " ", "\[CapitalDelta]"}]]}], 
   "-", 
   RowBox[{"18", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}], "+", 
   RowBox[{"6", " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
     "2", " ", "\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
     "3", " ", "\[ImaginaryI]", " ", "kx", " ", "\[CapitalDelta]"}]]}]}], 
  RowBox[{"12", " ", "\[CapitalDelta]"}]]], "Output",
 CellChangeTimes->{
  3.8516601807569227`*^9, 3.851660843296423*^9, 3.8516609296106915`*^9, {
   3.8516609598196754`*^9, 3.8516609758337955`*^9}, 3.851661119129901*^9, {
   3.85166118712864*^9, 3.8516612090854483`*^9}, 3.851661281769435*^9, 
   3.851662419876767*^9, 3.851662690758258*^9, 3.8516630963569345`*^9, 
   3.8516631960954847`*^9, 3.851663313279756*^9, 3.851664333984125*^9, {
   3.8516643660205135`*^9, 3.85166441408344*^9}, {3.851664475763582*^9, 
   3.8516645120909643`*^9}, 3.8516648216296487`*^9, 3.8516649433965206`*^9, {
   3.8516649884025803`*^9, 3.8516650074156933`*^9}, {3.8516650793731775`*^9, 
   3.851665144252197*^9}, {3.851665214039607*^9, 3.8516652728592196`*^9}, 
   3.8516653177121224`*^9, {3.851670864254758*^9, 3.851670881454444*^9}, 
   3.8516724779168167`*^9, 3.851672577269024*^9, 3.8516729861870985`*^9, 
   3.8516769409845166`*^9, 3.851679238297285*^9, 3.851679914431098*^9, 
   3.851681699340329*^9, {3.851682455800024*^9, 3.8516824705816293`*^9}, 
   3.8516826321899786`*^9, 3.8516852571349*^9, 3.851685998324029*^9, 
   3.8516861491297054`*^9, 3.851686416652753*^9, 3.8516865384190807`*^9, 
   3.851686643005312*^9, {3.851686728405466*^9, 3.8516867424596715`*^9}, 
   3.8516867948148794`*^9, 3.8516868332136097`*^9, {3.8516870089154153`*^9, 
   3.851687045110549*^9}, 3.8516873728084145`*^9, 3.851687482693406*^9, 
   3.851687671310689*^9, 3.8516877645382404`*^9, 3.851687947199271*^9, 
   3.8516880031999454`*^9, 3.8517529726769753`*^9, 3.851753096082775*^9, {
   3.851753135972509*^9, 3.8517531656193643`*^9}, 3.8517532294249306`*^9, {
   3.8517533418982472`*^9, 3.8517533618319874`*^9}, 3.851753415516742*^9, 
   3.8517536634865723`*^9, {3.851753755774682*^9, 3.851753769868865*^9}, 
   3.851754091487373*^9, {3.8517543650594473`*^9, 3.8517543756587086`*^9}, 
   3.8517547283105*^9, {3.8517553088459616`*^9, 3.8517553576794853`*^9}, 
   3.851755698107322*^9, {3.851755973776449*^9, 3.8517560307220554`*^9}, 
   3.8517560631122437`*^9, {3.851756230607539*^9, 3.851756263803573*^9}, {
   3.8517563021044593`*^9, 3.8517563189785457`*^9}, 3.8517564325233173`*^9, 
   3.8517564643102093`*^9, {3.8517569594495583`*^9, 3.851756982682752*^9}, 
   3.8517634718836656`*^9, {3.8517638020033555`*^9, 3.851763811968793*^9}, {
   3.851763873930807*^9, 3.8517639007931447`*^9}, {3.8517639853590465`*^9, 
   3.8517640043134117`*^9}, 3.8517641097648315`*^9, 3.8517641529694433`*^9, 
   3.851764184311282*^9, {3.8517643378342657`*^9, 3.8517643498327622`*^9}, {
   3.8517644149679527`*^9, 3.8517644578023357`*^9}, 3.851764491395444*^9, {
   3.851764531929758*^9, 3.8517645723261747`*^9}, {3.851764668059184*^9, 
   3.8517647052387614`*^9}, 3.8517647937739167`*^9, 3.8517648982792892`*^9, 
   3.8517649335557394`*^9, 3.8517649950652175`*^9, 3.851765026976819*^9, {
   3.851765076941906*^9, 3.851765092035578*^9}, 3.8517653648282194`*^9, 
   3.8517653984295273`*^9, 3.851766015284195*^9, 3.8517661110551105`*^9, 
   3.8517661576764097`*^9, {3.851766208032643*^9, 3.851766224828203*^9}, 
   3.8517662556397114`*^9, {3.851766457903621*^9, 3.8517664842142997`*^9}, {
   3.851766582701295*^9, 3.8517666017213745`*^9}, {3.8517666686122437`*^9, 
   3.8517667208139553`*^9}, 3.851767011356474*^9, 3.851767193939931*^9, 
   3.8517672528439045`*^9, 3.8517673930605636`*^9, 3.851767456362395*^9, 
   3.8517676398726335`*^9, {3.8517733374266834`*^9, 3.851773349910741*^9}, 
   3.851773455251825*^9, 3.8517734909787335`*^9, 3.8517858818214483`*^9, 
   3.8517859127184486`*^9, {3.851786006785085*^9, 3.8517860251669836`*^9}, 
   3.851786087990054*^9, 3.851786123919096*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"57492d94-644f-479f-8516-8f823ae03b28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DimX", " ", "=", " ", "40"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"sLen", " ", "=", " ", "4"}]}]}]], "Input",
 CellChangeTimes->{
  3.851609942294671*^9, {3.85165624530469*^9, 3.851656263664055*^9}, {
   3.851656325907131*^9, 3.8516563265748143`*^9}, {3.8516565769887533`*^9, 
   3.8516565830047626`*^9}, {3.851656789364543*^9, 3.851656790260483*^9}, {
   3.8516814904246683`*^9, 3.8516814905327516`*^9}, 3.851755276268262*^9, {
   3.8517553383820357`*^9, 3.851755339174095*^9}, {3.8517645494068627`*^9, 
   3.8517645494568357`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"b31d90ee-b510-4872-a278-76bcc94df947"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.8516585440724306`*^9, 3.851658698909961*^9, 3.8516591280777407`*^9, 
   3.8516608433423495`*^9, 3.8516609296616435`*^9, {3.8516609598686295`*^9, 
   3.8516609758882065`*^9}, 3.8516611191764064`*^9, {3.8516611871855955`*^9, 
   3.851661209134415*^9}, 3.851661281821387*^9, 3.85166241992772*^9, 
   3.85166269082189*^9, 3.851663096412915*^9, 3.851663196158863*^9, 
   3.851663313325735*^9, 3.8516643340430813`*^9, {3.8516643660734854`*^9, 
   3.8516644141417503`*^9}, {3.851664475812568*^9, 3.8516645121399364`*^9}, 
   3.8516648216806116`*^9, 3.851664943447491*^9, {3.8516649884565516`*^9, 
   3.8516650074876676`*^9}, {3.8516650794271593`*^9, 3.85166514432197*^9}, {
   3.8516652141034484`*^9, 3.851665272916169*^9}, 3.851665317767092*^9, {
   3.8516708643217187`*^9, 3.8516708815090647`*^9}, 3.8516724779867616`*^9, 
   3.8516725773356256`*^9, 3.851672986255743*^9, 3.8516769410686007`*^9, 
   3.851679238368244*^9, 3.8516799145048485`*^9, 3.8516816994062786`*^9, {
   3.8516824558744144`*^9, 3.85168247064293*^9}, 3.8516826322589207`*^9, 
   3.851685257205871*^9, 3.8516859983960915`*^9, 3.8516861491926584`*^9, 
   3.8516864167122016`*^9, 3.851686538491868*^9, 3.851686643071752*^9, {
   3.8516867284638453`*^9, 3.8516867425216365`*^9}, 3.851686794874854*^9, 
   3.851686833277568*^9, {3.8516870089879875`*^9, 3.8516870451702614`*^9}, 
   3.85168737287437*^9, 3.851687482756359*^9, 3.8516876713786526`*^9, 
   3.851687764596206*^9, 3.8516879472752647`*^9, 3.8516880032669044`*^9, 
   3.8517529727119985`*^9, 3.851753096117736*^9, {3.8517531360081987`*^9, 
   3.851753165656423*^9}, 3.851753229459911*^9, {3.851753341936219*^9, 
   3.85175336186497*^9}, 3.8517534155497093`*^9, 3.8517536635285482`*^9, {
   3.8517537558136606`*^9, 3.851753769908842*^9}, 3.851754091533122*^9, {
   3.851754365098425*^9, 3.8517543756976843`*^9}, 3.851754728357459*^9, {
   3.8517553088879623`*^9, 3.851755357723959*^9}, 3.851755698154276*^9, {
   3.851755973828437*^9, 3.851756030770011*^9}, 3.8517560631601706`*^9, {
   3.851756230656761*^9, 3.8517562638456955`*^9}, {3.85175630215042*^9, 
   3.8517563190235205`*^9}, 3.8517564325763865`*^9, 3.851756464385193*^9, {
   3.851756959534461*^9, 3.8517569827549515`*^9}, 3.8517634720683465`*^9, {
   3.8517638020813*^9, 3.8517638120417233`*^9}, {3.85176387397978*^9, 
   3.851763900843114*^9}, {3.8517639854090166`*^9, 3.8517640043643694`*^9}, 
   3.8517641098158035`*^9, 3.851764153018402*^9, 3.8517641843602905`*^9, {
   3.8517643384075766`*^9, 3.851764349878519*^9}, {3.85176441502592*^9, 
   3.8517644578530183`*^9}, 3.851764491443416*^9, {3.8517645319818974`*^9, 
   3.8517645723693314`*^9}, {3.8517646681049557`*^9, 3.8517647052797284`*^9}, 
   3.851764793815893*^9, 3.8517648983214817`*^9, 3.8517649335982246`*^9, 
   3.851764995106193*^9, 3.8517650270177965`*^9, {3.8517650769814034`*^9, 
   3.8517650920735483`*^9}, 3.8517653648721952`*^9, 3.8517653984755*^9, 
   3.8517660153261127`*^9, 3.851766111100417*^9, 3.851766157717626*^9, {
   3.8517662080716066`*^9, 3.8517662248651648`*^9}, 3.8517662556742496`*^9, {
   3.8517664579655867`*^9, 3.8517664842742615`*^9}, {3.8517665827652407`*^9, 
   3.851766601780327*^9}, {3.8517666686727595`*^9, 3.8517667208758545`*^9}, 
   3.851767011422626*^9, 3.8517671939768963`*^9, 3.851767252883873*^9, 
   3.8517673931025257`*^9, 3.8517674564023604`*^9, 3.8517676399115973`*^9, {
   3.8517733374706464`*^9, 3.8517733499527173`*^9}, 3.8517734553063436`*^9, 
   3.851773491017712*^9, 3.8517858818644257`*^9, 3.851785912763422*^9, {
   3.85178600683006*^9, 3.8517860252579317`*^9}, 3.851786088102991*^9, 
   3.8517861239580927`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"42ab9e12-17a1-4f8a-9d00-6fcf8b919a0c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grid", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"DimX", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "=", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "*", 
        RowBox[{"(", 
         RowBox[{"kx", "*", "\[CapitalDelta]", "*", "i"}], ")"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "5"}], "]"}], "]"}], "=", " ", 
      RowBox[{"-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", 
         RowBox[{"(", 
          RowBox[{"kx", "*", "\[CapitalDelta]", "*", "i"}], " ", ")"}]}], 
        "]"}]}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "DimX"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solveGrid", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"DimX", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derivativeGrid", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"DimX", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kEGrid", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "DimX", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wEGrid", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "DimX", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kBGrid", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "DimX", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wBGrid", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "DimX", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spb", " ", ":=", " ", "Sp"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Smb", " ", ":=", "Sm"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8516100166937556`*^9, 3.851610138041798*^9, {3.8516555643506594`*^9, 
   3.8516555700166345`*^9}, {3.8516556975810623`*^9, 3.85165569823786*^9}, {
   3.851655819989938*^9, 3.851655962672222*^9}, {3.8516560570354433`*^9, 
   3.85165610933749*^9}, {3.851656140607563*^9, 3.851656161416478*^9}, {
   3.8516562003366404`*^9, 3.8516563042716107`*^9}, {3.8516563655515256`*^9, 
   3.851656391733906*^9}, {3.8516564385929832`*^9, 3.8516564769699817`*^9}, {
   3.8516565124785304`*^9, 3.8516565748952017`*^9}, {3.8516566306462727`*^9, 
   3.8516566585154963`*^9}, {3.85165675630672*^9, 3.8516567564266524`*^9}, {
   3.851656871784666*^9, 3.851656904807681*^9}, {3.8516582999951115`*^9, 
   3.8516583057977304`*^9}, {3.851658340658848*^9, 3.8516584098391657`*^9}, 
   3.851658473741021*^9, {3.8516585108829126`*^9, 3.851658535489809*^9}, {
   3.8516586779618883`*^9, 3.851658679962346*^9}, {3.8516587908833585`*^9, 
   3.8516587951015167`*^9}, {3.851659019781827*^9, 3.851659084912775*^9}, {
   3.8516591410874205`*^9, 3.8516592163755407`*^9}, {3.8516594334319925`*^9, 
   3.851659444191434*^9}, {3.8516597194508457`*^9, 3.851659740440231*^9}, {
   3.8516597755689383`*^9, 3.851659845765437*^9}, {3.851660001864252*^9, 
   3.8516600263533697`*^9}, {3.851660237542031*^9, 3.8516602394536915`*^9}, {
   3.8516603443958597`*^9, 3.8516603522899213`*^9}, {3.851660513051341*^9, 
   3.8516605586553555`*^9}, {3.851660600924258*^9, 3.8516606336896224`*^9}, {
   3.851661109033412*^9, 3.851661147042592*^9}, {3.851661196824622*^9, 
   3.85166120087545*^9}, {3.851681692747592*^9, 3.851681695283065*^9}, {
   3.8516819912884893`*^9, 3.851682009235444*^9}, {3.8516824424030743`*^9, 
   3.851682467583324*^9}, {3.8517669275401583`*^9, 3.8517669457356234`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"60cb0c00-b9bc-419f-90a9-aad5c84bd9f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"kx", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "40"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"kx", ",", "10"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"derivative", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "6", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Sv", " ", "=", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Spb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Spb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Spb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Smb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Smb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Smb", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"gridPos", " ", "=", " ", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", " ", "-", " ", "sLen", " ", "+", "j"}], ")"}], 
               ",", "DimX", ",", " ", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"derivative", "=", " ", 
             RowBox[{"derivative", "+", 
              RowBox[{"Sv", ".", "Rx", ".", 
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"gridPos", ",", ";;"}], "]"}], "]"}]}]}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "7"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"derivative", " ", "=", " ", 
          RowBox[{"Bx", ".", 
           SuperscriptBox["Rx", "\[Transpose]"], ".", "derivative"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kEGrid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"derivative", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", "*", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wEGrid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
          RowBox[{
           RowBox[{"w", "[", "kx", "]"}], "/.", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"w", "[", "kx", "]"}]}], "+", 
                  RowBox[{"kEGrid", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "==", "0"}], "&&", 
                RowBox[{
                 RowBox[{"w", "[", "kx", "]"}], "\[NotEqual]", "0"}]}], ",", 
               " ", 
               RowBox[{"w", "[", "kx", "]"}], ",", "Complexes"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kBGrid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"derivative", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"\[ImaginaryI]", " ", "*", 
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "5"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wBGrid", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
          RowBox[{
           RowBox[{"w", "[", "kx", "]"}], "/.", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"w", "[", "kx", "]"}]}], "+", 
                  RowBox[{"kBGrid", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "==", "0"}], "&&", 
                RowBox[{
                 RowBox[{"w", "[", "kx", "]"}], "\[NotEqual]", "0"}]}], ",", 
               " ", 
               RowBox[{"w", "[", "kx", "]"}], ",", "Complexes"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"solveGrid", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kx", "*", "\[CapitalDelta]", "*", "i"}], " ", "-", 
              RowBox[{
               RowBox[{"wEGrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", "t"}]}], ")"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"solveGrid", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "5"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"kx", "*", "\[CapitalDelta]", "*", "i"}], " ", "-", 
               RowBox[{
                RowBox[{"wBGrid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", "t"}]}], ")"}]}], 
            "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "DimX"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"solveGrid", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "DimX"}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"N", "[", 
          RowBox[{"kEGrid", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "]"}], ";"}],
       FontSize->12], "*)"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0.0", ",", "1.5", " ", ",", "0.5"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8516100166937556`*^9, 3.851610138041798*^9, {3.8516555643506594`*^9, 
   3.8516555700166345`*^9}, {3.8516556975810623`*^9, 3.85165569823786*^9}, {
   3.851655819989938*^9, 3.851655962672222*^9}, {3.8516560570354433`*^9, 
   3.85165610933749*^9}, {3.851656140607563*^9, 3.851656161416478*^9}, {
   3.8516562003366404`*^9, 3.8516563042716107`*^9}, {3.8516563655515256`*^9, 
   3.851656391733906*^9}, {3.8516564385929832`*^9, 3.8516564769699817`*^9}, {
   3.8516565124785304`*^9, 3.8516565748952017`*^9}, {3.8516566306462727`*^9, 
   3.8516566585154963`*^9}, {3.85165675630672*^9, 3.8516567564266524`*^9}, {
   3.851656871784666*^9, 3.851656904807681*^9}, {3.8516582999951115`*^9, 
   3.8516583057977304`*^9}, {3.851658340658848*^9, 3.8516584098391657`*^9}, 
   3.851658473741021*^9, {3.8516585108829126`*^9, 3.851658535489809*^9}, {
   3.8516586779618883`*^9, 3.851658679962346*^9}, {3.8516587908833585`*^9, 
   3.8516587951015167`*^9}, {3.851659019781827*^9, 3.851659084912775*^9}, {
   3.8516591410874205`*^9, 3.8516592163755407`*^9}, {3.8516594334319925`*^9, 
   3.851659444191434*^9}, {3.8516597194508457`*^9, 3.851659740440231*^9}, {
   3.8516597755689383`*^9, 3.8516598030737934`*^9}, {3.851659982382327*^9, 
   3.851660044141878*^9}, {3.8516601971417875`*^9, 3.851660206585771*^9}, {
   3.8516602421716747`*^9, 3.851660321476286*^9}, {3.8516603578395433`*^9, 
   3.851660372603447*^9}, {3.851660410142912*^9, 3.8516604752570624`*^9}, {
   3.851660665497065*^9, 3.851660672024908*^9}, {3.8516608866447897`*^9, 
   3.8516609179399652`*^9}, {3.85166095547326*^9, 3.8516609672081184`*^9}, {
   3.8516610818999634`*^9, 3.8516610836451716`*^9}, {3.851661153221089*^9, 
   3.851661184653818*^9}, {3.8516612260810947`*^9, 3.85166127640525*^9}, {
   3.8516626579633718`*^9, 3.851662670338681*^9}, 3.851663193219166*^9, 
   3.851665092424032*^9, {3.8516717292809954`*^9, 3.851671798434578*^9}, {
   3.851672367348895*^9, 3.8516723837348557`*^9}, {3.8516724261471643`*^9, 
   3.851672426644836*^9}, {3.851672461170961*^9, 3.851672472209918*^9}, {
   3.85167256946204*^9, 3.8516725723212795`*^9}, {3.8516728069666796`*^9, 
   3.8516728920277567`*^9}, {3.851672978578924*^9, 3.851672979095619*^9}, {
   3.8516768970076866`*^9, 3.8516769167495513`*^9}, {3.8516792084026423`*^9, 
   3.851679226826329*^9}, {3.8516798854307184`*^9, 3.851679899186307*^9}, {
   3.851682320176913*^9, 3.8516823215799384`*^9}, {3.851682626567303*^9, 
   3.8516826282053185`*^9}, {3.851685155719876*^9, 3.8516851808232446`*^9}, 
   3.851685253792684*^9, {3.8516859313465443`*^9, 3.8516859368820114`*^9}, {
   3.8516860525613995`*^9, 3.8516860569736814`*^9}, {3.851686142959303*^9, 
   3.8516861456959434`*^9}, 3.8516865358525863`*^9, 3.851686639374089*^9, {
   3.8516867810690794`*^9, 3.8516867916085835`*^9}, {3.851686821700519*^9, 
   3.8516868298284636`*^9}, {3.8516870000383663`*^9, 3.851687003410693*^9}, {
   3.8516870395848627`*^9, 3.8516870408301306`*^9}, 3.8516873254612756`*^9, {
   3.8516873664630437`*^9, 3.8516873701743603`*^9}, 3.851687479933468*^9, {
   3.8516875974366894`*^9, 3.8516875993906746`*^9}, {3.85168766705309*^9, 
   3.8516876683626437`*^9}, {3.8516877607630424`*^9, 
   3.8516877803968725`*^9}, {3.851687913118526*^9, 3.8516879413237734`*^9}, 
   3.8516879777359333`*^9, {3.8517529505902433`*^9, 3.851752969268302*^9}, {
   3.85175308933044*^9, 3.8517530923664656`*^9}, {3.8517536586246243`*^9, 
   3.8517536595658236`*^9}, {3.8517537464649525`*^9, 
   3.8517537668069215`*^9}, {3.851754085188745*^9, 3.8517540875261307`*^9}, {
   3.85175437020571*^9, 3.851754373562173*^9}, {3.851754723061277*^9, 
   3.8517547252361546`*^9}, {3.851754995204694*^9, 3.851754995798518*^9}, 
   3.851755354601057*^9, {3.85175569465257*^9, 3.851755695280108*^9}, {
   3.851755962519371*^9, 3.851756059877142*^9}, {3.8517562254213896`*^9, 
   3.851756260886394*^9}, 3.851756297271431*^9, {3.8517564227006764`*^9, 
   3.8517564578227015`*^9}, {3.8517568346025906`*^9, 3.851756843869299*^9}, {
   3.8517568820908084`*^9, 3.851756979958273*^9}, {3.851757023646406*^9, 
   3.851757023770401*^9}, {3.851763466545283*^9, 3.8517634678042393`*^9}, {
   3.85176379770675*^9, 3.8517638097707057`*^9}, {3.851763852529029*^9, 
   3.8517638647359886`*^9}, {3.8517639826657047`*^9, 3.8517640025900507`*^9}, 
   3.8517641058574615`*^9, {3.8517641479002943`*^9, 3.851764182163227*^9}, {
   3.851764323946862*^9, 3.8517643478736715`*^9}, {3.851764409981655*^9, 
   3.8517645701127186`*^9}, {3.8517646997828217`*^9, 3.851764701505836*^9}, 
   3.8517649207085075`*^9, {3.85176497948857*^9, 3.851764982440767*^9}, {
   3.8517653867404227`*^9, 3.8517653958692656`*^9}, {3.8517676252247405`*^9, 
   3.851767637505516*^9}, {3.8517732697066917`*^9, 3.851773345400751*^9}, {
   3.8517734517084217`*^9, 3.8517734528869696`*^9}, {3.851785826476989*^9, 
   3.8517858502424936`*^9}, {3.8517859064166555`*^9, 
   3.8517859094084287`*^9}, {3.8517859942028303`*^9, 
   3.8517860224333525`*^9}, {3.8517860610785933`*^9, 
   3.8517860826719103`*^9}, {3.851786121107505*^9, 3.851786121200327*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"c9420478-f832-48b5-a150-5097d5f60cdf"],

Cell[BoxData["kx"], "Output",
 CellChangeTimes->{{3.851773333831412*^9, 3.8517733500082088`*^9}, 
   3.851773455375304*^9, 3.8517734910646863`*^9, 3.8517858819194064`*^9, 
   3.8517859128223877`*^9, {3.851786006890026*^9, 3.8517860253678694`*^9}, 
   3.851786088222923*^9, 3.851786124006048*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"8fb26611-0847-4956-8329-fefef370e797"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8516809963195696`*^9, 3.851681174653259*^9}, {
   3.851681496487994*^9, 3.8516814965949087`*^9}, {3.851681943989668*^9, 
   3.8516819454224224`*^9}, {3.8516820475400867`*^9, 
   3.8516820627885623`*^9}, {3.8516829543534765`*^9, 
   3.8516829680535626`*^9}, {3.851685855042279*^9, 3.85168585611231*^9}, {
   3.8516861576099024`*^9, 3.851686171214113*^9}, {3.8516867202833157`*^9, 
   3.8516867246643095`*^9}, {3.8516868998548856`*^9, 
   3.8516869082928247`*^9}, {3.8516870139347787`*^9, 3.851687023802826*^9}, 
   3.8516870543532095`*^9, {3.851687121868515*^9, 3.851687228871997*^9}, {
   3.851687439268426*^9, 3.8516874413255973`*^9}, {3.851687570832965*^9, 
   3.851687573701082*^9}, {3.851753117522666*^9, 3.851753221567895*^9}, {
   3.8517532763929377`*^9, 3.851753529534474*^9}, {3.8517538588448453`*^9, 
   3.851753864382311*^9}, {3.85175425380943*^9, 3.8517542709675217`*^9}, {
   3.8517551387394066`*^9, 3.8517551428607454`*^9}, 3.851755279603981*^9, {
   3.85175532448999*^9, 3.8517553249640217`*^9}, {3.8517557398415375`*^9, 
   3.851755854556955*^9}, {3.851756311170287*^9, 3.8517563122314835`*^9}, {
   3.8517646639954767`*^9, 3.8517646796372814`*^9}, 3.8517647909577074`*^9, 
   3.8517649170123515`*^9, {3.8517661904482317`*^9, 3.851766195209445*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"3cbd11ef-fb97-4d93-a88d-0d394f9f49f0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"k", "[", 
     RowBox[{"kx_", ",", "\[CapitalDelta]_", ",", "t_"}], "]"}], " ", "=", 
    " ", "kEGrid"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"kx", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "40"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", "=", "0"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"kEGrid", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kx", "=", 
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "40"}]}]}], ",", 
          RowBox[{"\[CapitalDelta]", "=", "1"}], ",", 
          RowBox[{"t", "=", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"k", "[", 
            RowBox[{"kx", ",", "\[CapitalDelta]", ",", "t"}], "]"}], "]"}], 
          ",", 
          RowBox[{"Im", "[", 
           RowBox[{"k", "[", 
            RowBox[{"kx", ",", "\[CapitalDelta]", ",", "t"}], "]"}], "]"}]}], 
         "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{"kEGrid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", ";", 
    "\[IndentingNewLine]", 
    RowBox[{"N", "[", 
     RowBox[{"wEGrid", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8517535695659075`*^9, 3.851753581872407*^9}, {
   3.8517537121265106`*^9, 3.851753732809719*^9}, {3.8517551539387665`*^9, 
   3.8517551603558207`*^9}, {3.8517659405601244`*^9, 
   3.8517660431441827`*^9}, {3.8517660765210266`*^9, 3.851766150912304*^9}, {
   3.851766203907513*^9, 3.851766252369131*^9}, {3.851766320726926*^9, 
   3.8517664826125813`*^9}, {3.851766537913066*^9, 3.8517667552682276`*^9}, {
   3.851767371515089*^9, 3.851767388571002*^9}, 3.8517674533040276`*^9, 
   3.851786373153748*^9},ExpressionUUID->"763812e5-0d1c-42ca-84ea-\
b752df4c3136"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[CapitalDelta]"], 
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.08333333333333333`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
  SuperscriptBox["2.718281828459045`", 
   FractionBox[
    RowBox[{
     SuperscriptBox["2.718281828459045`", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"1.`", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"115.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
            " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], ")"}]}], 
        "\[CapitalDelta]"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1.5`"}], " ", 
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"76.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}],
        "+", 
       RowBox[{"0.5`", " ", 
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"77.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}],
        "-", 
       RowBox[{"0.08333333333333333`", " ", 
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"78.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}],
        "+", 
       RowBox[{"0.25`", " ", 
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"114.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
            " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}],
        "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           RowBox[{"0.25`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.041666666666666664`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.75`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{"0.125`", " ", 
            SuperscriptBox["2.718281828459045`", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
              " ", "\[CapitalDelta]"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "+", 
              RowBox[{"115.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
            " ", 
            SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]], 
        " ", "kx", " ", 
        SuperscriptBox["\[CapitalDelta]", "2"]}]}], ")"}]}], 
    "\[CapitalDelta]"]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "18.`"}], " ", 
     SuperscriptBox["2.718281828459045`", 
      FractionBox[
       RowBox[{
        SuperscriptBox["2.718281828459045`", 
         FractionBox[
          RowBox[{
           SuperscriptBox["2.718281828459045`", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "-", 
               RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ",
              "\[CapitalDelta]"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.125`"}], "+", 
             RowBox[{"0.125`", " ", 
              SuperscriptBox["2.718281828459045`", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                  RowBox[{"40.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                " ", "\[CapitalDelta]"}]]}]}], ")"}]}], "\[CapitalDelta]"]], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.5`", " ", 
           SuperscriptBox["2.718281828459045`", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ",
              "\[CapitalDelta]"}]]}], "-", 
          RowBox[{"0.5`", " ", 
           SuperscriptBox["2.718281828459045`", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ",
              "\[CapitalDelta]"}]]}], "+", 
          RowBox[{"0.08333333333333333`", " ", 
           SuperscriptBox["2.718281828459045`", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ",
              "\[CapitalDelta]"}]]}], "-", 
          RowBox[{"0.25`", " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "0.75`"}], " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "-", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "-", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]]}]}], ")"}]}], "\[CapitalDelta]"]]}], "+", 
    RowBox[{"6.`", " ", 
     SuperscriptBox["2.718281828459045`", 
      FractionBox[
       RowBox[{
        RowBox[{"1.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "-", 
        RowBox[{"0.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "+", 
        RowBox[{"0.08333333333333333`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "-", 
        RowBox[{"0.25`", " ", 
         SuperscriptBox["2.718281828459045`", 
          FractionBox[
           RowBox[{
            RowBox[{"0.125`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{"0.125`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
           "\[CapitalDelta]"]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
         SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}], 
    "-", 
    RowBox[{"1.`", " ", 
     SuperscriptBox["2.718281828459045`", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.25`"}], " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "-", 
             RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "+", 
        RowBox[{"1.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "-", 
        RowBox[{"0.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "+", 
        RowBox[{"0.08333333333333333`", " ", 
         SuperscriptBox["2.718281828459045`", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
           "\[CapitalDelta]"}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
         SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}], 
    "+", 
    RowBox[{"3.`", " ", 
     SuperscriptBox["2.718281828459045`", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.25`"}], " ", 
         SuperscriptBox["2.718281828459045`", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.25`"}], " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.25`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
           "\[CapitalDelta]"]]}], "+", 
        RowBox[{"1.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.75`"}], " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.75`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
           "\[CapitalDelta]"]]}], "+", 
        RowBox[{"0.08333333333333333`", " ", 
         SuperscriptBox["2.718281828459045`", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.25`"}], " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.041666666666666664`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{"0.041666666666666664`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.25`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
             " ", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
           "\[CapitalDelta]"]]}], "-", 
        RowBox[{"0.5`", " ", 
         SuperscriptBox["2.718281828459045`", 
          FractionBox[
           RowBox[{
            RowBox[{"0.125`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{"0.25`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.041666666666666664`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{"0.041666666666666664`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "+", 
            RowBox[{"0.25`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                 RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{"0.125`", " ", 
             SuperscriptBox["2.718281828459045`", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", "\[CapitalDelta]"}]]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"0.`", "\[VeryThinSpace]", "+", 
               RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
             " ", 
             SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
           "\[CapitalDelta]"]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0.`", "\[VeryThinSpace]", "+", 
           RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", " ", 
         SuperscriptBox["\[CapitalDelta]", "2"]}]}], "\[CapitalDelta]"]]}], 
    "+", 
    RowBox[{"10.`", " ", 
     SuperscriptBox["2.718281828459045`", 
      FractionBox[
       RowBox[{
        SuperscriptBox["2.718281828459045`", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"1.`", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"115.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], ")"}]}], 
           "\[CapitalDelta]"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.5`", " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"76.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]]}], "-", 
          RowBox[{"0.5`", " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"77.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]]}], "+", 
          RowBox[{"0.08333333333333331`", " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"3.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"38.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"78.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]]}], "-", 
          RowBox[{"0.25`", " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"114.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           SuperscriptBox["2.718281828459045`", 
            FractionBox[
             RowBox[{
              RowBox[{"0.25`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
                 " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.041666666666666664`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"37.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.75`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{"0.125`", " ", 
               SuperscriptBox["2.718281828459045`", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                   RowBox[{"39.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx",
                  " ", "\[CapitalDelta]"}]]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.`", "\[VeryThinSpace]", "+", 
                 RowBox[{"115.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "kx", 
               " ", 
               SuperscriptBox["\[CapitalDelta]", "2"]}]}], 
             "\[CapitalDelta]"]], " ", "kx", " ", 
           SuperscriptBox["\[CapitalDelta]", "2"]}]}], ")"}]}], 
       "\[CapitalDelta]"]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.851767393836504*^9, 3.851767457163754*^9, 3.851767641019539*^9, {
   3.851773338447835*^9, 3.851773350979166*^9}, {3.851785886887029*^9, 
   3.8517859144654493`*^9}, 3.851786011618228*^9, 3.8517860958933697`*^9, 
   3.851786198220111*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"232d8b5b-71fc-4a0e-a7de-aea192689f1e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"derivative", " ", "=", "  ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sv", " ", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Spb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"Spb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"Spb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"Smb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"Smb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"Smb", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gridPos", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", "sLen", " ", "+", "j"}], ")"}], ",", 
        "DimX", ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"derivative", "=", " ", 
      RowBox[{"derivative", "+", 
       RowBox[{"Sv", ".", "Rx", ".", 
        RowBox[{"grid", "[", 
         RowBox[{"[", 
          RowBox[{"gridPos", ",", ";;"}], "]"}], "]"}]}]}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "7"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"derivative", " ", "=", " ", 
   RowBox[{"Bx", ".", 
    SuperscriptBox["Rx", "\[Transpose]"], ".", "derivative"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kEGrid", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"derivative", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[ImaginaryI]", "*", 
       RowBox[{"grid", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wEGrid", "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", 
   RowBox[{
    RowBox[{"w", "[", "kx", "]"}], "/.", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"w", "[", "kx", "]"}]}], "+", 
           RowBox[{"kEGrid", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "==", "0"}], "&&", 
         RowBox[{
          RowBox[{"w", "[", "kx", "]"}], "\[NotEqual]", "0"}]}], ",", " ", 
        RowBox[{"w", "[", "kx", "]"}], ",", "Complexes"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8517647374091873`*^9, 3.8517647568062143`*^9}, {
  3.8517648328770676`*^9, 3.8517648413323526`*^9}, {3.8517648855951304`*^9, 
  3.8517648957114024`*^9}, {3.851767186294548*^9, 3.851767190508165*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"4569b443-aafb-46a5-981a-99eba38bef2d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kx", "=", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "40"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"kEGrid", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Re", "[", "kEGrid", "]"}], "]"}], ",", 
     RowBox[{"N", "[", 
      RowBox[{"Im", "[", "kEGrid", "]"}], "]"}]}], "}"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"wEGrid", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8517648666524134`*^9, 3.8517648698279696`*^9}, {
   3.851764949650449*^9, 3.851765140323058*^9}, {3.851765317746512*^9, 
   3.851765361968553*^9}, {3.8517654212887836`*^9, 3.8517654821343*^9}, 
   3.8517656961590567`*^9, {3.8517658630519285`*^9, 3.8517659219938717`*^9}, {
   3.8517671765056314`*^9, 3.851767179568034*^9}, {3.851767211300004*^9, 
   3.851767218579402*^9}, 3.851767249749549*^9, {3.8517673356170177`*^9, 
   3.851767359950982*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"99707b3b-2ded-4ea9-ab36-36ff75a3b9bd"],

Cell[BoxData[
 RowBox[{"0.15708435827789052`", "\[VeryThinSpace]", "+", 
  RowBox[{"6.220546247901152`*^-7", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.85176589404576*^9, 3.8517659230557585`*^9}, 
   3.851766019839389*^9, 3.851766115861727*^9, 3.851766162407968*^9, {
   3.8517662122112713`*^9, 3.8517662291291103`*^9}, 3.8517662601514645`*^9, {
   3.851766463730822*^9, 3.8517664902195635`*^9}, {3.8517665891693463`*^9, 
   3.851766604178556*^9}, {3.8517666711873226`*^9, 3.85176672332483*^9}, 
   3.8517670157061787`*^9, {3.85176718030641*^9, 3.851767198188512*^9}, {
   3.8517672504235716`*^9, 3.8517672535884733`*^9}, 3.8517673617036686`*^9, 
   3.851767394607091*^9, 3.851767460815364*^9, {3.8517733385086594`*^9, 
   3.851773351043111*^9}, {3.8517858869689817`*^9, 3.851785914516421*^9}, 
   3.8517860134316344`*^9, 3.8517861148468747`*^9, 3.851786374822562*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"849e0c22-0ef2-49b7-8de5-001782d72bd4"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.851764856606738*^9, 3.851764865972313*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"913616f4-c082-4a54-80ed-d9ac9c1422e6"]
},
WindowSize->{890.5, 630.5},
WindowMargins->{{Automatic, 365}, {145.5, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"04afefd4-ef6f-4b03-bfb8-562df8695bfb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 405, 6, 28, "Input",ExpressionUUID->"92928561-9f78-4bfc-8796-b3d12eac8b59"],
Cell[966, 28, 9496, 280, 409, "Input",ExpressionUUID->"4a26795d-819f-4858-9da9-b34a67d0100f"],
Cell[CellGroupData[{
Cell[10487, 312, 4724, 135, 388, "Input",ExpressionUUID->"b10cf8ca-9da7-47d9-b3d5-a7ad51bad5a9"],
Cell[15214, 449, 4481, 70, 51, "Output",ExpressionUUID->"57492d94-644f-479f-8516-8f823ae03b28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19732, 524, 701, 13, 67, "Input",ExpressionUUID->"b31d90ee-b510-4872-a278-76bcc94df947"],
Cell[20436, 539, 3736, 51, 32, "Output",ExpressionUUID->"42ab9e12-17a1-4f8a-9d00-6fcf8b919a0c"]
}, Open  ]],
Cell[24187, 593, 4276, 100, 295, "Input",ExpressionUUID->"60cb0c00-b9bc-419f-90a9-aad5c84bd9f0"],
Cell[CellGroupData[{
Cell[28488, 697, 12362, 254, 459, "Input",ExpressionUUID->"c9420478-f832-48b5-a150-5097d5f60cdf"],
Cell[40853, 953, 374, 5, 32, "Output",ExpressionUUID->"8fb26611-0847-4956-8329-fefef370e797"]
}, Open  ]],
Cell[41242, 961, 1392, 19, 28, "Input",ExpressionUUID->"3cbd11ef-fb97-4d93-a88d-0d394f9f49f0"],
Cell[CellGroupData[{
Cell[42659, 984, 2321, 60, 219, "Input",ExpressionUUID->"763812e5-0d1c-42ca-84ea-b752df4c3136"],
Cell[44983, 1046, 37372, 854, 792, "Output",ExpressionUUID->"232d8b5b-71fc-4a0e-a7de-aea192689f1e"]
}, Open  ]],
Cell[82370, 1903, 3110, 85, 182, "Input",ExpressionUUID->"4569b443-aafb-46a5-981a-99eba38bef2d"],
Cell[CellGroupData[{
Cell[85505, 1992, 1365, 33, 143, "Input",ExpressionUUID->"99707b3b-2ded-4ea9-ab36-36ff75a3b9bd"],
Cell[86873, 2027, 963, 13, 32, "Output",ExpressionUUID->"849e0c22-0ef2-49b7-8de5-001782d72bd4"]
}, Open  ]],
Cell[87851, 2043, 171, 2, 28, "Input",ExpressionUUID->"913616f4-c082-4a54-80ed-d9ac9c1422e6"]
}
]
*)

